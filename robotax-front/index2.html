<!DOCTYPE html>
<!-- Hi there, curious. The future belongs to robots and those who program them. -->
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>RoboTax - APP</title>
		<meta name="description" content="A responsive, magazine-like website layout with a grid item animation effect when opening the content" />
		<meta name="keywords" content="grid, layout, effect, animated, responsive, magazine, template, web design" />
		<meta name="author" content="Codrops" />
		<link rel="shortcut icon" href="../favicon.ico">
		<link rel="stylesheet" type="text/css" href="css/normalize.css" />
		<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="css/style2.css" />
		<link rel="stylesheet" type="text/css" href="css/sweetalert.css">

		<script src="js/modernizr.custom.js"></script>

		<!-- Maybe put this shit somewhere else, in like custom.css -->
		<style type="text/css">
		
			.fileUpload {
			    position: relative;
			    overflow: hidden;
			    margin: 10px;
			}
			.fileUpload input.upload {
			    position: absolute;
			    top: 0;
			    right: 0;
			    margin: 0;
			    padding: 0;
			    font-size: 20px;
			    cursor: pointer;
			    opacity: 0;
			    filter: alpha(opacity=0);
			}
		</style>
		<script type="text/javascript">
		var totalDeduct = 0;

		function showtotalamount(){
			swal({   title: "Total deductible amount!",   text: "Your taxable income is reduced by this amount: <h2>" + totalDeduct.toPrecision(3).toString() + " € </h2> Congratulations!!",   imageUrl: "http://t4t5.github.io/sweetalert/example/images/thumbs-up.jpg" , html: true});
		}
			function hideElem(id) {
			    document.getElementById(id).style.visibility = "hidden"; 
			}

			function showElem(id) {
			    document.getElementById(id).style.visibility = "visible"; 
			}


		</script>
	</head>
	<body>

		<div class="container">
			<button id="menu-toggle" class="menu-toggle"><span>Menu</span></button>
			<div id="theSidebar" class="sidebar">
				<button class="close-button fa fa-fw fa-close"></button>

				<!-- Cause yeah, it needs to be directly accessible, for iPad it's ready -->
				

						<div class="fileUpload fa fa-camera">
							<span>Add New Receipt</span>
							<form id="badass" action="http://robo.tax:8080/docs/" method="post">
								<input id="thepic" type="file" class="upload" accept="image/*" capture="camera" onchange="picChange(event)" value="">
							</form>
						</div>
						
				
				<h1><span>RoboTax<span> Receipts List</h1>
				<nav class="codrops-demos">
					<a href="">This week</a>
					<a class="current-demo" href="">All</a>
				</nav>
				<div class="related">
					<h3>Categories</h3>
					<a href="">Job</a>
					<a href="">Building/Housing</a>
					<a href="">Financial</a>
					<a href="">Other</a>
				</div>

				<!-- Maybe put this whole shit in a modal, Export functionnality and Dashboard are pretty scarce -->
				<a onclick="showtotalamount()" class="fileUpload fa fa-dashboard">
					<span href="">View Dashboard</span>
				</a>
				<a href="http://robo.tax:8080/export" class="fileUpload fa fa-file-excel-o">
					<span href="">Export Recap</span>
				</a>

			</div>
			<div id="theGrid" class="main">
				<section id="bsa" class="grid">
					<header class="top-bar">
						<h2 class="top-bar__headline">Latest receipts</h2>
						<div class="filter">
							<span>Filter by:</span>
							<span class="dropdown">Newest</span>
							<span class="dropdown">Oldest</span>
						</div>
					</header>
				  	<!-- Grid items go here, those are displayed on the main page ;) -->
				  	
					<a id="1" class="grid__item" href="#">
						<h2 class="title title--preview"></h2>
						<div class="loader"></div>
						<span class="category"></span>
						<div class="meta meta--preview">
							<img class="meta__avatar" src="img/status/ok.png"/> 
							<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
							<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
						</div>
					</a>
					<a id="2" class="grid__item" href="#">
						<h2 class="title title--preview"></h2>
						<div class="loader"></div>
						<span class="category"></span>
						<div class="meta meta--preview">
							<img class="meta__avatar" src="img/status/ok.png"/> 
							<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
							<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
						</div>
					</a>
					<a id="3" class="grid__item" href="#">
						<h2 class="title title--preview"></h2>
						<div class="loader"></div>
						<span class="category"></span>
						<div class="meta meta--preview">
							<img class="meta__avatar" src="img/status/ok.png"/> 
							<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
							<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
						</div>
					</a>
					<a id="4" class="grid__item" href="#">
						<h2 class="title title--preview"></h2>
						<div class="loader"></div>
						<span class="category"></span>
						<div class="meta meta--preview">
							<img class="meta__avatar" src="img/status/ok.png"/> 
							<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
							<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
						</div>
					</a>
					<a id="5" class="grid__item" href="#">
						<h2 class="title title--preview"></h2>
						<div class="loader"></div>
						<span class="category"></span>
						<div class="meta meta--preview">
							<img class="meta__avatar" src="img/status/ok.png"/> 
							<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
							<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
						</div>
					</a>
					<a id="6" class="grid__item" href="#">
						<h2 class="title title--preview"></h2>
						<div class="loader"></div>
						<span class="category"></span>
						<div class="meta meta--preview">
							<img class="meta__avatar" src="img/status/ok.png"/> 
							<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
							<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
						</div>
					</a>

					<!-- A usability thing for Mobile users, maybe put it on top? -->
				</section>
				<section class="content">
					<div id="abs" class="scroll-wrap">
						<!-- Corresponds to grid item 1 -->
						<article id="1a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>
						<article id="1a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>

						<article id="2a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>

						<article id="3a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>

						<article id="4a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>

						<article id="5a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>

				<article id="6a" class="content__item">
							<span class="category category--full"></span>
							<h2 class="title title--full"></h2>
							<div class="meta meta--full">
								<img class="meta__avatar" src="img/status/ok.png" />
								<span class="meta__author"></span>
								<span class="meta__date"><i class="fa fa-calendar-o"></i> </span>
								<span class="meta__reading-time"><i class="fa fa-clock-o"></i> </span>
								<span class="meta__misc meta__misc--seperator"><i class="fa fa-comments-o"></i> Approved</span>
								<span class="meta__misc"><i class="fa fa-heart"></i> Stuff </span>
								<nav class="article-nav">
									<button><i class="fa fa-angle-left"></i> <span>Previous</span></button>
									<button><span>Next</span> <i class="fa fa-angle-right"></i></button>
								</nav>
							</div>
							<p class="contentGoesHere" ></p>
						</article>				
					</div>
					<button class="close-button"><i class="fa fa-close"></i><span>Close</span></button>
				</section>
			</div>

		</div><!-- /container -->
		<script src="js/classie.js"></script>
		<script src="js/main.js"></script>

		<!-- Sweet alert, this shit is dope! Confirm the reception from Gini or is it refundable or not -->
		<script src="js/sweetalert.min.js"></script> 
		<script src="js/handlebars-v3.0.3.js"></script>
		<script type="text/javascript">
			swal({   title: "Version 0.5",   text: "This is the dev Server",   type: "success",   confirmButtonText: "Cool" });
		</script>
		<script type="text/javascript">
		  var showId = 1;
                  var obj = null;
			function picChange(evt){ 

				var fileInput = evt.target.files;
				if(fileInput.length>0){
					var windowURL = window.URL || window.webkitURL; 
					var picURL = windowURL.createObjectURL(fileInput[0]);
					var photo = new Image();
					var formData = new FormData();
					photo.onload = function(){
					  //draw photo into canvas when ready
					  formData.append("name", fileInput[0].name);
					  formData.append("fileupload", fileInput[0]);			  
					  fileInput[0].name;
					  var request = new XMLHttpRequest();
					  var theFile = "http://robo.tax:8080/docs/" + fileInput[0].name;
					  request.open("POST", theFile);
		request.send(formData);

                
		                          obj = JSON.parse(httpGet(theFile)) ;
					  console.log(obj);
					  add(obj, showId.toString());


					  showId += 1;

					  sweetAlert("Oops...", "It looks like your purchase is not tax deductible or there was some error. Maybe take a picture again to be sure. :(", "error");

					  swal({   title: "Your taxable income was reduced by "  + obj.Mwst.toPrecision(2).toString() + " euros" + " !",   text: "The " + obj.docType + " from " + obj.paymentRecipient + " of an amount of " + obj.amountToPay.toString() + " is tax deductible. " ,   type: "success",   showCancelButton: true,   confirmButtonColor: "#DD6B55",   confirmButtonText: "Looks good!",   cancelButtonText: "Not good!",   closeOnConfirm: false,   closeOnCancel: false }, function(isConfirm){   if (isConfirm) {     swal("Added!", "The record has been added.", "success");   } else {     swal("Cancelled", "The record has been discarded, you like throwing money away do you?", "error");   } });

					  
					};
					//load photo into canvas
					photo.src = picURL;
					// windowURL.revokeObjectURL(picURL);
				}
			}
			function httpGet(theUrl)
			{
				sleep(6000);
			    var xmlHttp = new XMLHttpRequest();
			    
			    xmlHttp.open( "GET", theUrl, false );
			    xmlHttp.setRequestHeader("Accept", "application/json");
			    xmlHttp.send( null );
			    console.log(xmlHttp.responseText)
			    return xmlHttp.responseText;
			}
			function sleep(milliseconds) {
			  var start = new Date().getTime();
			  for (var i = 0; i < 1e7; i++) {
			    if ((new Date().getTime() - start) > milliseconds){
			      break;
			    }
			  }
			}

			function add(obj, id){
		    var articleId = id.toString() + "a";
                                console.log("FUCK MY LIFE");
				console.log(obj);
				var link = document.getElementById(id);
link.getElementsByClassName("category")[0].innerHTML = obj.cat;
link.getElementsByClassName("title title--preview")[0].innerHTML = obj.paymentRecipient;
link.getElementsByClassName("fa fa-calendar-o")[0].innerHTML =  " " + obj.subcat;
totalDeduct += obj.Mwst;
link.getElementsByClassName("fa fa-clock-o")[0].innerHTML = " " + obj.Mwst.toPrecision(2).toString() + " €";

				var article = document.getElementById(articleId);
				console.log(article)

article.getElementsByClassName("category category--full")[0].innerHTML = obj.cat;
article.getElementsByClassName("title title--full")[0].innerHTML = obj.paymentRecipient;
article.getElementsByClassName("meta__author")[0].innerHTML = "Default User";
article.getElementsByClassName("fa fa-calendar-o")[0].innerHTML =  " " + obj.subcat;
article.getElementsByClassName("fa fa-clock-o")[0].innerHTML = " " + obj.Mwst.toPrecision(2).toString() + " €";

article.getElementsByClassName("contentGoesHere")[0].innerHTML = obj.original_file;



				showElem(id);
				// should be json
				// total amount of bill that is deductible, what is not deductible total,, 
				//inject article
				

				// var articleScript = document.getElementById("article-template").innerHTML;
				// var articleTemplate = Handlebars.compile(articleScript);  
				// document.getElementById("abs").innerHTML += articleTemplate(obj);
				// console.log(articleTemplate(obj));
				
			}

			hideElem("1");
			hideElem("2");
			hideElem("3");
			hideElem("4");
			hideElem("5");
			hideElem("6");

		</script>



	</body>
</html>
